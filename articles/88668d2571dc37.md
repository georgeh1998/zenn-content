---
title: "App ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® BuildConfig ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ä½¿ã† (android, hilt)"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["android", "kotlin", "gradle", "hilt"]
published: true
---

# ã¯ã˜ã‚ã«

ãƒãƒ«ãƒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¢ãƒ—ãƒªã§ App ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® BuildConfig ãªã©ã®è¨­å®šã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã®ãƒ¡ãƒ¢ã§ã™ã€‚

# ã‚¢ãƒ—ãƒªæ§‹æˆ

- app ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå„æ©Ÿèƒ½ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¾å­˜ã—ã¾ã™ã€‚
- å„æ©Ÿèƒ½ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ repository ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¾å­˜ã—ã¾ã™ã€‚
- repository ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ databse,network ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¾å­˜ã—ã¾ã™ã€‚

![](/images/88668d2571dc37/app_structure.png)

# å®Ÿè£…

### resource ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œæˆã€ AppConfig ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹

è¨­å®šå€¤ã‚’ä¿æŒã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’æŒã¤ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ã€resources ã‚’ä½œæˆã—ã¾ã™ã€‚
ãã®ä¸­ã«ä¸‹è¨˜ã®ã‚ˆã†ãª `AppConfig` ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚
ä»Šå›ã¯ API ã‚¢ã‚¯ã‚»ã‚¹ã® URL ã‚’ app ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å®šç¾©ã—ã¦ã¿ã¾ã™ã€‚ãªã®ã§ `baseUrl`ã¨ã„ã†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®šç¾©ã—ã¦ã¿ã¾ã—ãŸã€‚

```kt
data class AppConfig(
    val isDebug: Boolean,
    val baseUrl: String
)
```

### app:build.gradle ã«è¨­å®šå€¤ã‚’è¿½åŠ ã—ã€BuildConfig ã«å…¥ã‚Œã‚‹ã€‚

```kt
android {
    buildTypes {
        debug {
            buildConfigField("String", "BASE_URL", '"https://debug"')
        }
        release {
            buildConfigField("String", "BASE_URL", '"https://release"')
        }
    }
}
```

### app ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã« hilt ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚

app ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒ `AppConfig`ã‚’çŸ¥ã‚‰ãªã„ã¨è¡Œã‘ãªã„ã®ã§ä¾å­˜ã«è¿½åŠ ã—ã¾ã™ã€‚

```kt
// app:build.gradle
dependencies {
    implementation(project(":util"))
}
```

hilt ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã€å¿…è¦ãªå€¤ã‚’ BuildConfig ã‹ã‚‰è¨­å®šã—ã¾ã™ã€‚

```kt
@Module
@InstallIn(SingletonComponent::class)
object AppModule {

    @Provides
    @Singleton
    fun appConfig(): AppConfig {
        return AppConfig(
            isDebug = BuildConfig.DEBUG,
            baseUrl = BuildConfig.BASE_URL
        )
    }
}
```

ä»¥ä¸Šã§ `AppConfig` ã‚’ä½¿ã†æº–å‚™ãŒå®Œäº†ã—ã¾ã—ãŸã€‚

# AppConfig ã‚’ä½¿ã†

ä¾‹ãˆã° netowork ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ä½¿ç”¨ã—ãŸã„å ´åˆã‚’è€ƒãˆã¾ã™ã€‚

ã¾ãšã¯ network ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® build.gradle ã« resources ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾å­˜ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```kotlin
// network:build.gradle
dependencies {
    implementation(project(":util"))
}
```

network ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã® hilt ã§ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚Œã° `AppConcig` ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

```kotlin
@Module
@InstallIn(SingletonComponent::class)
object NetworkModule {

    @Singleton
    @Provides
    fun provideRetrofit(
        appConfig: AppConfig // DIã•ã‚Œã‚‹
    ): Retrofit {
        return Retrofit.Builder()
            .baseUrl(appConfig.baseUrl)
            .build()
    }
}

```

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾å­˜é–¢ä¿‚ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

![](/images/88668d2571dc37/app_structure_with_resources.png)

# ã¾ã¨ã‚

Gradle ã®ãƒãƒ«ãƒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆã«ã¦ã€Hilt ã‚’ä½¿ç”¨ã—ã¦ app ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è¨­å®šå€¤ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã®è§£èª¬ã‚’ã—ã¾ã—ãŸã€‚

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¯ã«è¨­å®šå€¤ãŒã‚ã‚‹å ´åˆã€ä¾‹ãˆã° network ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ databse ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å¿…è¦ãªå ´åˆã¯ãã‚Œãã‚Œã€`NetworkConfig`, `DatabaseConfig` ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ã¿ã¦ã‚‚è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ãƒãƒ«ãƒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ“ãƒ«ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã¾ã¨ã‚ã‚‹è¨˜äº‹ã‚‚ä½œæˆã—ã¦ã„ã‚‹ã®ã§ã€æ˜¯éèª­ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚(Qiita ã§ã™ãŒã€‚ã€‚ğŸ˜‚)
https://qiita.com/gotlin/items/67ee341fb379b5d58af6

# å‚è€ƒ

- https://star-zero.medium.com/multimodule%E3%81%A8buildconfig-5a39f0133bca
- https://zenn.dev/sobya/articles/de5300703f3830fc608c
- https://codechacha.com/ja/android-buildconfig/
