---
title: "読書感想文-Linuxのしくみ"
emoji: "🍣"
type: "tech"
topics: ["linux", "読書"]
published: false
---

# はじめに

[Linux のしくみ カーネルを知ってステップアップ]()を呼みました。その中で覚えておきたいキーワードや概念を、書籍の目次順でまとめます。

# Linux の概要

「カーネルがなぜ必要か」、「システムコールとは何か」などの基本的な内容が書かれている。
概念は知っているがそれを確認するためのいくつかの下記のコマンドが紹介されており、知らないものや使ったことがないものもあった。

## strace

発行したシステムコールを確認する。

- `-T`オプションでシステムコールの所要時間をマイクロ秒で出力できるため、ボトルネックの処理があるときの調査などで使えそう。

```bash
$ strace -T -o <出力ファイル> <コマンド>
```

## sar

論理 CPU が実行している命令の割合を確認する。
ユーザーモード、カーネルモード、アイドル状態など、それぞれの比率を確認できる。

- `-P 0`は論理 CPU0 を表す
- その次の`1`は 1 秒ごとにデータを採取する意味
- その次の`1`は 1 回だけデータを採取する意味

```bash
$ sar -P 0 1 1
```

## taskset

任意のコマンドを指定した論理 CPU で実行する。

```bash
$ taskset -c <論理CPU番号> <コマンド>
```

### ldd

実行ファイルにリンクされているライブラリを確認できる。
python など多くの言語は C の上で動いていることは知っていたが、以下コマンドで標準 C ライブラリがリンクされていることを実際に確認した。

```
$ ldd /usr/bin/python3
```

静的リンクというのもあり、ビルド時に実行ファイル内にライブラリの関数を組み込みます。
`golang`の実行ファイルは基本的には静的リンクで、`ldd`で確認すると共有リンクがないことが分かる。
(私の環境では`golang`の実行ファイルでも、共有ライブラリがリンクされているものもあった。)
静的リンクが使用される理由は以下。

- サイズが多くなりがちだが、現代の PC ならそれほどの大きな問題ではない。
- 別の環境での実行も容易
- 実行時の共有ライブラリリンクがないため速い
- 共有ライブラリのアップデートで発生しがちな、「DLL 地獄」を回避できる。

# プロセス管理(基礎編)

# プロセススケジューラ

# メモリ管理システム

# プロセス管理(応用編)

# デバイスアクセス

# ファイルシステム

# 記憶階層

# ブロック層

# 仮想化機能

# コンテナ

# cgroup

# 今後
